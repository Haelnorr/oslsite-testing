---
import { validateUser } from "../../../../util/authUtils";
import { srlmPost } from "../../../../util/srlmUtils";
import { steam } from "../../../../util/steamUtils";


try {

    const steam_resp = await steam.authenticate(Astro.request)

    const userToken: string = Astro.cookies.get('user_token')?.value;

    const user = await validateUser(userToken);

    if (user) {
        const resp = await srlmPost(`/users/${user.user}/steam`, '', {steam_id: steam_resp.steamid});
    }

    return Astro.redirect(`//${Astro.url.host}/profile`)

} catch (error) {
    console.error(error)
}





---

